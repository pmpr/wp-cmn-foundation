<?php
/*   _______________________________________
    |  Obfuscated by PMPR - Php Obfuscator  |
    |             68dbbdda66681             |
    |_______________________________________|
*/
 namespace Pmpr\Common\Foundation\ORM\Database; use Pmpr\Common\Foundation\Container\LightContainer; use SQLite3; class SQLite extends LightContainer { protected ?SQLite3 $db = null; protected ?string $table = null; public function wwiwswsasquukoqs() : ?SQLite3 { return $this->db; } public function omagaeayasgsammo(string $uukaekcwkasqoaqa) { if (extension_loaded('sqlite3')) { $this->db = new SQLite3($uukaekcwkasqoaqa); } return $this->db; } public function aqkyoweegqwuwsgw(string $aasascamegmwqmqk) : self { $this->table = $aasascamegmwqmqk; return $this; } public function ueykigukusgcmcsg() : ?string { return $this->table; } public function esyewoquwqmukwcy(array $wkkweuacukumqmya) : bool { $waaaiiqwsmggwsak = []; foreach ($wkkweuacukumqmya as $ymqmyyeuycgmigyo => $sqeykgyoooqysmca) { $waaaiiqwsmggwsak[] = "{$ymqmyyeuycgmigyo} {$sqeykgyoooqysmca}"; } $gqgemcmoicmgaqie = "CREATE TABLE IF NOT EXISTS {$this->ueykigukusgcmcsg()} (" . implode(', ', $waaaiiqwsmggwsak) . ")"; return $this->wwiwswsasquukoqs()->exec($gqgemcmoicmgaqie); } public function exists(string $syqouamccooucaoe, $qeswqcwwseygoeiy) : bool { $uyqkoakmakeeqayg = $this->db->prepare("SELECT 1 FROM {$this->table} WHERE {$syqouamccooucaoe} = :val LIMIT 1"); $uyqkoakmakeeqayg->umckqwcagasewoqo(':val', $qeswqcwwseygoeiy, is_int($qeswqcwwseygoeiy) ? SQLITE3_INTEGER : SQLITE3_TEXT); $sogksuscggsicmac = $uyqkoakmakeeqayg->execute()->oeymawqewksoyqeu(SQLITE3_NUM); return $sogksuscggsicmac !== false; } public function insert(array $icwicymcioeyeyek) : bool { $yygmoeguaqyumuui = array_keys($icwicymcioeyeyek); $kqmcoiicsmgwaisg = array_map(fn($wgywewwaswowuooi) => ":{$wgywewwaswowuooi}", $yygmoeguaqyumuui); $uyqkoakmakeeqayg = $this->db->prepare("INSERT OR REPLACE INTO {$this->table} (" . implode(', ', $yygmoeguaqyumuui) . ") VALUES (" . implode(', ', $kqmcoiicsmgwaisg) . ")"); foreach ($icwicymcioeyeyek as $uusmaiomayssaecw => $eqgoocgaqwqcimie) { $uyqkoakmakeeqayg->umckqwcagasewoqo(":{$uusmaiomayssaecw}", $eqgoocgaqwqcimie, is_int($eqgoocgaqwqcimie) ? SQLITE3_INTEGER : SQLITE3_TEXT); } return $uyqkoakmakeeqayg->execute() !== false; } public function update(array $icwicymcioeyeyek, string $syqouamccooucaoe, $qeswqcwwseygoeiy) : bool { $qugqiksmicsyicgg = []; foreach ($icwicymcioeyeyek as $uusmaiomayssaecw => $eqgoocgaqwqcimie) { $qugqiksmicsyicgg[] = "{$uusmaiomayssaecw} = :{$uusmaiomayssaecw}"; } $uyqkoakmakeeqayg = $this->db->prepare("UPDATE {$this->table} SET " . implode(', ', $qugqiksmicsyicgg) . " WHERE {$syqouamccooucaoe} = :_where"); foreach ($icwicymcioeyeyek as $uusmaiomayssaecw => $eqgoocgaqwqcimie) { $uyqkoakmakeeqayg->umckqwcagasewoqo(":{$uusmaiomayssaecw}", $eqgoocgaqwqcimie, is_int($eqgoocgaqwqcimie) ? SQLITE3_INTEGER : SQLITE3_TEXT); } $uyqkoakmakeeqayg->umckqwcagasewoqo(":_where", $qeswqcwwseygoeiy, is_int($qeswqcwwseygoeiy) ? SQLITE3_INTEGER : SQLITE3_TEXT); return $uyqkoakmakeeqayg->execute() !== false; } public function delete(string $syqouamccooucaoe, $qeswqcwwseygoeiy) : bool { $uyqkoakmakeeqayg = $this->db->prepare("DELETE FROM {$this->table} WHERE {$syqouamccooucaoe} = :val"); $uyqkoakmakeeqayg->umckqwcagasewoqo(':val', $qeswqcwwseygoeiy, is_int($qeswqcwwseygoeiy) ? SQLITE3_INTEGER : SQLITE3_TEXT); return $uyqkoakmakeeqayg->execute() !== false; } public function get(string $syqouamccooucaoe, $qeswqcwwseygoeiy) : ?array { $uyqkoakmakeeqayg = $this->db->prepare("SELECT * FROM {$this->table} WHERE {$syqouamccooucaoe} = :val LIMIT 1"); $uyqkoakmakeeqayg->umckqwcagasewoqo(':val', $qeswqcwwseygoeiy, is_int($qeswqcwwseygoeiy) ? SQLITE3_INTEGER : SQLITE3_TEXT); $sogksuscggsicmac = $uyqkoakmakeeqayg->execute()->oeymawqewksoyqeu(SQLITE3_ASSOC); return $sogksuscggsicmac ?: null; } public function megmggkiokqkcwou() : array { $qeiakyocuggicwsy = []; $wcgmoqucoyqgmicy = $this->db->query("SELECT * FROM {$this->table}"); while ($keuwuekioomqqaey = $wcgmoqucoyqgmicy->oeymawqewksoyqeu(SQLITE3_ASSOC)) { $qeiakyocuggicwsy[] = $keuwuekioomqqaey; } return $qeiakyocuggicwsy; } public function close() : void { $this->db->close(); } }
